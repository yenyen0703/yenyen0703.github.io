/** Credits - Do not edit/remove this comment (Read http://sweepabit.com/LICENSE)
 * @desc Sweepabit.com core source file
 * @author Dexon <dexon@live.ca> (https://github.com/Dexon95)
 * @contributors uniibu (https://github.com/uniibu)
 */
function setBet(e){game.bet=parseFloat(parseFloat(e).toFixed(2)),betSave=game.bet,"undefined"!=$.cookie("gameBet")&&$.removeCookie("gameBet"),$.cookie("gameBet",betSave)}function setBombs(e){game.bombs=Math.floor(parseFloat(e)),"undefined"!=$.cookie("gameBombs")&&$.removeCookie("gameBombs"),$.cookie("gameBombs",game.bombs)}function setClientSeed(e){game.clientSeed=parseFloat(e),"undefined"!=$.cookie("clientSeed")&&$.removeCookie("clientSeed"),$.cookie("clientSeed",game.clientSeed)}function getURLParameter(e){return decodeURIComponent((new RegExp("[#|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.hash)||[,""])[1].replace(/\+/g,"%20"))||null}function onkeyup_check(e){13==e.keyCode&&sendMessage(document.getElementById("chatText").value)}function sendMessage(e){document.getElementById("chatText").value="",socket.emit("new_message",{text:e},function(e,t){return e?void console.log("Error when submitting new_message to server:",e):void console.log("Successfully submitted message:",t)})}function ObjectLength(e){var t=0;for(var a in e)e.hasOwnProperty(a)&&++t;return t}function addNewChatMessage(e){if("undefined"!=typeof e.user&&"undefined"!=typeof e.channel)var t=escapeHTML(e.user.uname),a=e.user.role;else var t="Server",a="server";var o="",s={hours:addZero(new Date(e.created_at).getHours()),mins:addZero(new Date(e.created_at).getMinutes())},n=escapeHTML(e.text);n=stripCombiningMarks(n);var i=!1;""!=$("#username").text()&&n.indexOf("@"+$("#username").text())>-1&&(t!=$("#username").text()&&(i=!0),n=n.replace("@"+$("#username").text(),"<span class='notify'>@"+$("#username").text()+"</span>"));var c=document.getElementById("chatMonitor"),l="OWNER"==a?"style='color:#1791a5;":"ADMIN"==a?"style='color:#1791a5;":"MOD"==a?"style='color:#028a3b;":"style='";i2="OWNER"==a?"<span>A: </span>":"ADMIN"==a?"<span>A: </span>":"MOD"==a?"<span>M: </span>":" ",isInHighRollersList(t)&&(o='<span style="margin:0px 2px; color:#04c8ff;">DL</span>'),l+="'",c.innerHTML+='<div class="chatMessage"><p><small>'+s.hours+":"+s.mins+"</small> <b "+l+">"+i2+o+t+"</b>: "+urlify(n)+"</p></div>",c.scrollTop=c.scrollHeight;var r=document.getElementsByClassName("chatMessage");r.length>120&&c.removeChild(r[0]),$(".safeLink").click(function(){var e=$(this).text();$("#unknownLink").text(e),$(".safeLinkDoRedirectButton").attr("href",e),$("#safeLinkForm").modal("setting","closable",!1).modal("show"),$("#safeLinkCancelRedirectButton").click(function(){$("#safeLinkForm").modal("hide")})})}function addZero(e){return 10>e&&(e="0"+e),e}function onloadCallback(){grecaptcha.render("faucetClaimCaptcha",{sitekey:"6LdILioTAAAAAE0mLZMxw8eJqHG-EX-iDsOOsz8j",callback:correctCaptcha})}function correctCaptcha(e){$.ajax({type:"POST",contentType:"application/json",url:"https://api.moneypot.com/v1/claim-faucet?access_token="+access_token,data:JSON.stringify({response:e}),dataType:"json"}).done(function(e){console.log(e.amount/100+" has been added to your balance!"),$.get("https://api.moneypot.com/v1/auth?access_token="+access_token,function(e){"undefined"!=typeof e.user.uname&&(user_balance=e.user.balance/100,$("#balance").text(user_balance.formatMoney(2,".",",")))}),$("#success_faucetDonut").modal("show"),$("#faucetClaimCaptcha").slideUp("fast"),grecaptcha.reset(),showingrecaptcha=!1,claimedTime=(new Date).getTime(),faucetTimer=setInterval(function(){return parseInt(claimedTime)+3e5<=(new Date).getTime()?($("#faucetButton").removeClass("claimed"),clearInterval(faucetTimer),claimedTime=!1,$("#faucetButton").attr("disabled",!1),void $("#faucetButton").html("<i class='fa fa-gift' aria-hidden='true'></i>")):($("#faucetButton").attr("disabled",!0),$("#faucetButton").addClass("claimed"),void $("#faucetButton").text(parseInt(300-((new Date).getTime()-claimedTime)/1e3)))},100),"undefined"!=$.cookie("faucetClaim")&&$.removeCookie("faucetClaim"),$.cookie("faucetClaim",claimedTime)}).fail(function(e){var t=e.error;"FAUCET_ALREADY_CLAIMED"==t?(console.error("Faucet already claimed"),addNewChatMessage({created_at:(new Date).getTime().toISOString(),text:"You already claimed the faucet. (All moneypot apps shares the same faucet and therefore the same timer)"}),grecaptcha.reset(donutRecaptcha)):"INVALID_INPUT_RESPONSE"==t&&console.error("Google has rejected the response. Try to refresh and do again."),$("#404_faucetDonut").modal("show"),grecaptcha.reset(),$("#faucetClaimCaptcha").slideUp("fast"),showingrecaptcha=!1})}function startNewGame(){if(!connected)return $("#theDimmer").html('Sorry. You\'re not connected. <br><a href="https://www.moneypot.com/oauth/authorize?app_id=2286&response_type=token&state=donut&redirect_uri=http://donutbit.com">Login now .</a>'),void $("#game_left").dimmer("show");if($(".settingsButon").css("display","none"),game.bombs<1||game.bombs>24)return $("#theDimmer").html("Sorry. Adjust the number of traps to 1-24 only."),$("#game_left").dimmer("show"),void $(".settingsButon").css("display","inline-block");if(game.tilesClicked=0,houseEdge=.01,odds=(25-game.bombs-game.tilesClicked)/(25-game.tilesClicked),next=game.bet*((1-houseEdge)/odds)-game.bet,game={status:"IN_PROGRESS",profit:0,bet:game.bet,bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:odds,next:next,stake:game.bet},user_balance-game.bet<0)return $("#theDimmer").html("Sorry. You don't have enough balance."),$("#game_left").dimmer("show"),game={status:"ENDED",profit:game.stake,bet:parseFloat($("#bet").val()),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},void $(".settingsButon").css("display","inline-block");if(game.bet<0)return $("#theDimmer").html("Sorry. Your bet is invalid."),$("#game_left").dimmer("show"),game={status:"ENDED",profit:game.stake,bet:parseFloat($("#bet").val()),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},void $(".settingsButon").css("display","inline-block");$("#cashoutButton").css("display","inline-block"),$("#next_value").text(parseFloat(game.next).formatMoney(2,".",",")),$("#stake_value").text(parseFloat(game.stake).formatMoney(2,".",",")),boardHtml=$("#board").html(),$("#board").html("");for(var e=0;25>e;e++)$("#board").append("<div data-tile='"+e+"' class='tile'></div>");$(".tile").each(function(e){$(this).click(function(){if("IN_PROGRESS"==game.status){custom.saveBet(custom.username,game.bet);var t=!1;if($(".tile").each(function(e){$(this).hasClass("tileLoading")&&(t=!0)}),!t){user_balance-=game.stake,$("#balance").text(user_balance.formatMoney(2,".",",")),parseInt($(this).attr("data-tile")),$(this).addClass("tileLoading"),$(this).html('<div class="ui active loader"></div>');var a=100*game.stake;console.log("[BET] Game:",game);var o=Math.floor(Math.pow(2,32)*game.odds);game.tilesClicked++;var s=$(this);$.ajax({type:"POST",contentType:"application/json",url:"https://api.moneypot.com/v1/bets/custom?access_token="+access_token,data:JSON.stringify({client_seed:parseInt(game.clientSeed),hash:String(Hash),wager:a,payouts:[{from:0,to:o,value:100*(game.stake+game.next)},{from:o,to:Math.pow(2,32),value:0}]}),dataType:"json",error:function(e,t,a){console.error("[BET ERROR]",e.responseText)}}).done(function(t){if(s.removeClass("tileLoading"),console.log("[BET RESULT]",t),t.next_hash)if(console.log("[Provably fair] new hash: "+t.next_hash),Hash=t.next_hash,t.outcome>=o){if(s.addClass("pressed"),s.addClass("bomb reveal"),s.html('<img class="ui fluid image" src="lib/css/img/toasted.png" alt="toasted-donutbit.com" >'),$("#logs").html('<div class="log_item item"><div class="right floated content"><div class="info"><a href="https://www.moneypot.com/bets/'+t.id+'" target="_blank"><i class="info circle icon"></i></a></div></div><img class="ui avatar image" src="lib/css/img/toasted-list.png"><div class="content"><a class="header" href="https://www.moneypot.com/bets/'+t.id+'" target="_blank">Bitter Donut!</a><div class="description"><p>Baked on oven #<a href="https://www.moneypot.com/bets/'+t.id+'" target="_blank"><b>'+e+"</b></a>. Oh no! It got toasted. </p></div></div></div>"+$("#logs").html()),$(".game_log_button").append('<button id="playAgainButton" class="ui green button">Bake Again</button>'),$(".game_log_button").css("display","block"),$("#playAgainButton").click(function(){$("#game_actions").css("display","none"),$("#playAgainButton").remove(),$("#board").html(boardHtml),$("#customBombs").val(game.bombs),$("#startNewGameButton").click(function(){startNewGame()}),$("#bombsButtons .button").each(function(e){$(this).click(function(){$("#bombsButtons .button").each(function(){$(this).removeClass("active")}),$(this).addClass("active"),0===e?game.bombs=1:1===e?game.bombs=3:2===e?game.bombs=5:3===e?game.bombs=24:4===e&&(game.bombs=parseInt($("#customBombs").val())),$(this).hasClass("customBombsButton")?$("#customBombsInputArea").css("display","inline-flex"):$("#customBombsInputArea").css("display","none")})}),game={status:"ENDED",profit:game.stake,bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#bet").val(game.bet)}),game.bombs>1)for(var a=0;a<game.bombs-1;a++){var n=[];$(".tile").each(function(e){$(this).hasClass("pressed")||$(this).hasClass("reveal")||n.push(e)}),roll=Math.floor(Math.random()*n.length)+1,$(".tile:eq("+n[roll-1]+")").addClass("reveal").html('<img class="ui fluid image" src="lib/css/img/toasted.png" alt="toasted-donutbit.com" >')}$("#cashoutButton").css("display","none"),game={status:"ENDED",profit:0-parseFloat($("#bet").val()),bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#next_value").text(parseFloat(game.next).formatMoney(2,".",",")),$("#stake_value").text(parseFloat(game.stake).formatMoney(2,".",",")),$(".log_item").each(function(e){e>5&&$(this).remove()}),console.log(game),$(".settingsButon").css("display","inline-block")}else s.addClass("pressed"),s.html('<img class="ui fluid image" src="lib/css/img/sweet.png" alt="toasted-donutbit.com" >'),$("#logs").html('<div class="log_item item"><div class="right floated content"><div class="info"><a href="https://www.moneypot.com/bets/'+t.id+'" target="_blank"><i class="info circle icon"></i></a></div></div><img class="ui avatar image" src="lib/css/img/sweet-list.png"><div class="content"><a class="header" href="https://www.moneypot.com/bets/'+t.id+'" target="_blank">Sweet Donut!</a><div class="description"><p>Baked on oven #<a href="https://www.moneypot.com/bets/'+t.id+'" target="_blank"><b>'+e+'</b></a>. You earned <span style="font-weight:bold; color: #00c517;">'+parseFloat(game.next).formatMoney(2,".",",")+"</span> bits</p></div></div></div>"+$("#logs").html()),user_balance+=game.next+game.stake,$("#balance").text(user_balance.formatMoney(2,".",",")),houseEdge=.01,odds=(25-game.bombs-game.tilesClicked)/(25-game.tilesClicked),next=(game.bet+game.next)*((1-houseEdge)/odds)-(game.bet+game.next),game={status:"IN_PROGRESS",profit:0,bet:game.bet+game.next,bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:game.tilesClicked,odds:odds,next:next,stake:game.bet+game.next},$("#next_value").text(parseFloat(game.next).formatMoney(2,".",",")),$("#stake_value").text(parseFloat(game.stake).formatMoney(2,".",",")),$(".log_item").each(function(e){e>5&&$(this).remove()}),console.log(game);else console.log("BET ERROR: "+JSON.stringify(t.responseJSON)),$("#theDimmer").html("BET ERROR: "+JSON.stringify(t.responseJSON)+'<br><a href="https://www.moneypot.com/oauth/authorize?app_id=2286&response_type=token&state=donut&redirect_uri=http://donutbit.com">Click here to reconnect</a>'),$("#game_left").dimmer("show"),$(".settingsButon").css("display","inline-block")})}}})}),console.log("~~ New game ~~\n",game),$("#lets-bake-segment").css("display","none"),$("#game_actions").css("display","flex"),$("#game_log").css("display","block"),$(this).css("display","inline-block")}function showSettings(){$("#theDimmer").html('<div class="ui form"><h4 class="ui horizontal divider header">Bet Amount</h4><div class="field"><input class="bet" type="number" pattern="[0-9]*" value="'+betSave+'" onkeyup="setBet($(this).val());" onchange="setBet($(this).val());"></div><h4 class="ui horizontal divider header">Toasted Traps</h4><div class="ui field"><input class="bet" type="number" pattern="[0-9]*" value="'+game.bombs+'" onkeyup="setBombs($(this).val());" onchange="setBombs($(this).val());"></div><h4 class="ui horizontal divider header">Client Seed</h4><div class="field"><input class="bet" type="number" pattern="[0-9]*" value="'+game.clientSeed+'" onkeyup="setClientSeed($(this).val());" onchange="setClientSeed($(this).val());"></div></div>'),$("#game_left").dimmer("show")}function escapeHTML(e){e+="";for(var t="",a=0;a<e.length;a++)t+="<"===e[a]?"&lt;":">"===e[a]?"&gt;":"'"===e[a]?"&#39;":'"'===e[a]?"&#34;":"%"===e[a]?"&#37;":"\\"===e[a]?"&#92;":"Â¢"===e[a]?"&#162;":"Â¼"===e[a]?"&#188;":"Â½"===e[a]?"&#189;":"Â¾"===e[a]?"&#190;":"#"===e[a]?"&#35;":"&"===e[a]&&"#"===e[a+1]?"&#38;":e[a];return t}function urlify(e){var t=/(https?:\/\/[^\s]+)/g;return e.replace(t,function(e){return'<a class="safeLink">'+e+"</a>"})}function isInHighRollersList(e){var t=!1;return $(".hr_log_item_username").each(function(){$(this).text()==e&&(t=!0)}),t}function getRandCseed(){var e=new Uint32Array(1);return window.crypto.getRandomValues(e)[0]}var socket,users=0,Hash="",showingrecaptcha=!1,boardHtml="",user_balance=0,claimedTime=!1,faucetTimer,access_token=null,currentSafeLink="",jackpot_socket,jackpot_streak=0;if("undefined"==typeof $.cookie("faucetClaim")?(claimedTime=!1,$.cookie("faucetClaim",claimedTime)):(claimedTime=parseInt($.cookie("faucetClaim")),claimedTime&&claimedTime>0&&(faucetTimer=setInterval(function(){return parseInt(claimedTime)+3e5<=(new Date).getTime()?($("#faucetButton").removeClass("claimed"),clearInterval(faucetTimer),claimedTime=!1,$("#faucetButton").attr("disabled",!1),$("#faucetButton").html("<i class='fa fa-gift' aria-hidden='true'></i>"),"undefined"!=$.cookie("faucetClaim")&&$.removeCookie("faucetClaim"),void $.cookie("faucetClaim",claimedTime)):($("#faucetButton").attr("disabled",!0),$("#faucetButton").addClass("claimed"),void $("#faucetButton").text(parseFloat(300-((new Date).getTime()-claimedTime)/1e3).formatMoney(2,".",",")))},100))),"undefined"==typeof $.cookie("gameBet")){var betSave=2;$.cookie("gameBet",betSave)}else var betSave=$.cookie("gameBet");if("undefined"==typeof $.cookie("gameBombs")){var gameBombs=3;$.cookie("gameBombs",gameBombs)}else var gameBombs=$.cookie("gameBombs");var connected=!1;if("undefined"==typeof $.cookie("clientSeed")){var clientSeed=getRandCseed();$.cookie("clientSeed",clientSeed)}else var clientSeed=$.cookie("clientSeed");var game={status:"?",profit:0,bet:parseFloat(betSave),bombs:parseInt(gameBombs),clientSeed:clientSeed,tilesClicked:0,odds:0,next:0,stake:0};$("#bet").val(game.bet),$("#bombsButtons .button").each(function(e){1==game.bombs?0===e?$(this).addClass("active"):$(this).removeClass("active"):3==game.bombs?1===e?$(this).addClass("active"):$(this).removeClass("active"):5==game.bombs?2===e?$(this).addClass("active"):$(this).removeClass("active"):24==game.bombs?3===e?$(this).addClass("active"):$(this).removeClass("active"):4===e?($(this).addClass("active"),$("#customBombs").val(game.bombs),$("#customBombsInputArea").css("display","inline-flex")):$(this).removeClass("active")}),$(function(){var e=jQuery("<div/>",{id:"loaderContainer",style:"position: absolute; top: 0; right: 0; bottom: 0; left: 0; z-index: 2000;"}).appendTo("body"),t=jQuery("<div/>",{"class":"ui segment",style:"height: 100%; opacity: 1; border:none;"}).appendTo(e),a=jQuery("<div/>",{"class":"preloader-donutbit ui active dimmer"}).appendTo(t);jQuery("<div/>",{id:"loaderText","class":"ui text loader",text:"Loading the awesome bitcoin donut game .. "}).appendTo(a),"undefined"!=typeof $.session.get("session_access_token")&&(access_token=$.session.get("session_access_token")),""!=getURLParameter("access_token")&&null!=getURLParameter("access_token")&&(access_token=getURLParameter("access_token"),"undefined"!=typeof $.session.get("session_access_token")&&$.session.remove("session_access_token"),$.session.set("session_access_token",access_token),window.history.pushState("","Donutbit","/")),socket=io.connect("https://socket.moneypot.com");var o={app_id:2286,access_token:""!=access_token&&null!=access_token?access_token:void 0,subscriptions:["CHAT","DEPOSITS","BETS"]};socket.on("connect",function(){(user_balance>0||null!=access_token)&&(connected=!0),console.info("[socketpot] connected");var e={app_id:o.app_id,access_token:o.access_token,subscriptions:o.subscriptions};socket.emit("auth",e,function(e,t){if(e)return $("#loaderContainer").css("display","block"),$("#loaderText").text("Error while connecting: "+e),void console.error("[auth] Error:",e);var a=t;$(".main_container").fadeIn(500),$("#loaderContainer").fadeOut(1e3),""!=access_token&&null!=access_token&&($(".donutbit-greet-mobile").css("display","none"),$("#connectButton").css("display","none"),$("#legendaryDonuts_cont").css("display","block"),$("#headerFuncBtn").css("display","flex"),$("#game_allbets_log").css("display","block"),jQuery("<input/>",{id:"chatText",type:"text",maxlength:"200",placeholder:"I won 1 BTC :)"}).appendTo("#chatFunction"),jQuery("<button/>",{id:"chatButton",text:"Send"}).appendTo("#chatFunction"),$("#chatButton").addClass("ui primary button"),$("#chatText").keyup(function(e){onkeyup_check(e)}),$("#chatButton").click(function(){sendMessage(String(document.getElementById("chatText").value))}),$.getJSON("https://api.moneypot.com/v1/token?access_token="+access_token,function(e){console.log(e.auth.user.uname),custom.username=e.auth.user.uname,$(".welcome-buttons li").css("display","block"),$(".donutbit-greet h2").prepend('Hi <span id="username"></span> ! '),$("#connectionText").css("display","block"),$("#betPanel").css("display","block"),$("#username").text(e.auth.user.uname),$("#balance").text((e.auth.user.balance/100).formatMoney(2,".",",")),user_balance=e.auth.user.balance/100,connected=!0,$("#highRoller_log").css("display","block"),$("#highRoller_logs").html('<div class="ui active loader"></div>'),$.post("https://api.moneypot.com/v1/hashes?access_token="+access_token,"",function(e){return console.log("[Provably fair] We received our hash: "+e.hash),Hash="undefined"!=typeof e.hash&&e.hash,$("#loaderContainer").css("display","none"),""==Hash||0==Hash?($("#theDimmer").html('Error: Moneypot did not give a correct hash!<br><a href="https://www.moneypot.com/oauth/authorize?app_id=2286&response_type=token&state=donut&redirect_uri=http://donutbit.com">Click here to reconnect</a><br>Error: '+JSON.stringify(e).replace(access_token,"[censored]")),$("#game_left").dimmer("show"),void $(".settingsButon").css("display","inline-block")):void 0},"json"),$(".chatMessage").each(function(e){$(this).html().split(":")[1],$(this).html($(this).html().replace("@"+$("#username").text(),"<span class='notify'>@"+$("#username").text()+"</span>"))})}),$.getJSON("https://api.moneypot.com/v1/list-bets?access_token="+access_token+"&app_id=2286&wager=50000&limit=6&order_by=desc",function(e){$("#highRoller_logs").html(""),e.length>0&&$.each(e.reverse(),function(t){e[t].profit<=0?$("#highRoller_logs").html('<div class="ui item"><div class="content"><div class="header"><a href="https://www.moneypot.com/users/'+e[t].uname+'">'+e[t].uname+'</a></div> Toasted: <span style="color:#ff0000;">'+parseFloat(e[t].wager/100).formatMoney(2,".",",")+'</span> Bits. <div class="info"><a href="https://www.moneypot.com/bets/'+e[t].id+'" target="_blank">Check bet</a></div></div></div>'+$("#highRoller_logs").html()):$("#highRoller_logs").html('<div class="ui item"><div class="content"><div class="header"><a href="https://www.moneypot.com/users/'+e[t].uname+'">'+e[t].uname+'</a></div> Baked: <span style="color:#00c517;">'+parseFloat(e[t].wager/100).formatMoney(2,".",",")+'</span> Bits. <div class="info"><a href="https://www.moneypot.com/bets/'+e[t].id+'" target="_blank">Check bet</a></div></div></div>'+$("#highRoller_logs").html()),$(".hr_log_item").each(function(e){e>10&&$(this).remove()})})}),console.log(a)),users=ObjectLength(a.chat.userlist),$("#connectedUsersAmount").text(users);for(var o=0;o<a.chat.messages.length;o++)addNewChatMessage(a.chat.messages[o]);document.getElementById("chatMonitor");$(".safeLink").click(function(){var e=$(this).text();$("#unknownLink").text(e),$(".safeLinkDoRedirectButton").attr("href",e),$("#safeLinkForm").modal("setting","closable",!1).modal("show"),$("#safeLinkCancelRedirectButton").click(function(){$("#safeLinkForm").modal("hide")})})})}),socket.on("disconnect",function(){console.warn("[socketpot] disconnected"),document.getElementById("chatMonitor").innerHTML="",connected=!1,$("#loaderContainer").css("display","block"),$("#loaderText").text("Lost connection to socketpot. If this happens many time, verify your connection or contact moneypot support."),console.error("Lost connection to socketpot. If this happens many time, verify your connection or contact moneypot support.")}),socket.on("client_error",function(e){console.error("[socketpot] client_error:",e)}),socket.on("error",function(e){console.error("[socketpot] error:",e)}),socket.on("reconnect_error",function(e){console.error("[socketpot] error while reconnecting:",e),console.info("Couldn't connect to socketpot. Verify your connection or contact moneypot support."),$("#loaderContainer").css("display","block"),$("#loaderText").text("Error while reconnecting! Couldn't connect to socketpot. Verify your connection or contact moneypot support."),connected=!1}),socket.on("reconnecting",function(){console.warn("[socketpot] attempting to reconnect..."),console.info("Couldn't connect to socketpot. Verify your connection or contact moneypot support."),$("#loaderContainer").css("display","block"),$("#loaderText").text("Reconnecting"),connected=!1}),socket.on("reconnect",function(){console.info("[socketpot] successfully reconnected"),$("#loaderContainer").css("display","none"),connected=!0}),socket.on("user_joined",function(e){users++,$("#connectedUsersAmount").text(users),console.log(e.uname+" joined the chat. ("+users+" users online)")}),socket.on("user_left",function(e){users--,$("#connectedUsersAmount").text(users),console.log(e.uname+" left the chat. ("+users+" users online)")}),socket.on("new_message",function(e){addNewChatMessage(e)}),socket.on("new_bet",function(e){if($("#username").text()==e.uname){var t=document.getElementById("game_mybets_logs"),a=t.insertRow(0);a.id="mybet_"+e.id,a.className="mybets_log_item";var o=a.insertCell(0),s=a.insertCell(1),n=a.insertCell(2),i=parseFloat(e.profit)>=0;o.innerHTML='<a href="https://www.moneypot.com/bets/'+e.id+'" target="blank">'+e.id+"</a>",o.className=i?"win":"lose",s.innerHTML=parseFloat(parseFloat(e.wager/100).toFixed(2))+" Bits",n.innerHTML=i?'<span style="color: #8D4">'+(e.profit/100).formatMoney(2,".",",")+"</span> Bits":'<span style="color:#c10e0e;">'+(e.profit/100).formatMoney(2,".",",")+"</span> Bits",jackpot_streak>0&&(n.innerHTML=n.innerHTML+'<div style="width: 10px;height: 10px;background: gold;position: absolute;right: 10px;margin-top: -15px;border-radius: 50%;color: black;font-size: 7px;text-align: center;line-height: 10px;font-weight: bold;" title="Jackpot Streak '+jackpot_streak+'">'+jackpot_streak+"</div>"),e.wager/100>=1e5&&(e.profit<=0?$("#highRoller_logs").html('<div class="hr_log_item" style="border-left: 4px solid #E74C3C;"><b><a class="hr_log_item_username" href="https://www.moneypot.com/users/'+e.uname+'">'+e.uname+'</a></b>: <span style="color: #E74C3C">'+parseFloat(e.wager/100).formatMoney(2,".",",")+'</span> Bits! <div class="info"><a href="https://www.moneypot.com/bets/'+e.id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#highRoller_logs").html()):$("#highRoller_logs").html('<div class="hr_log_item" style="border-left: 4px solid #8D4;"><b><a class="hr_log_item_username" href="https://www.moneypot.com/users/'+e.uname+'">'+e.uname+'</a></b>: <span style="color: #8D4">'+parseFloat(e.wager/100).formatMoney(2,".",",")+'</span> Bits! <div class="info"><a href="https://www.moneypot.com/bets/'+e.id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#highRoller_logs").html()),$(".hr_log_item").each(function(e){e>10&&$(this).remove()})),$(".mybets_log_item").each(function(e){e>8&&$(this).remove()})}var t=document.getElementById("game_allbets_logs"),a=t.insertRow(0);a.id="bet_"+e.id,a.className="allbets_log_item";var o=a.insertCell(0),s=a.insertCell(1),n=a.insertCell(2),i=parseFloat(e.profit)>=0;o.innerHTML='<a href="https://www.moneypot.com/bets/'+e.id+'" target="blank">'+e.id+"</a>",o.className=i?"win":"lose",s.innerHTML='<a href="https://www.moneypot.com/users/'+e.uname+'">'+e.uname+"</a>",n.innerHTML=i?'<span style="color: #8D4">'+(e.profit/100).formatMoney(2,".",",")+"</span> Bits":'<span style="color:#c10e0e;">'+(e.profit/100).formatMoney(2,".",",")+"</span> Bits",e.wager/100>=1e5&&(e.profit<=0?$("#highRoller_logs").html('<div class="hr_log_item" style="border-left: 4px solid #E74C3C;"><b><a class="hr_log_item_username" href="https://www.moneypot.com/users/'+e.uname+'">'+e.uname+"</a></b>: <span>"+parseFloat(e.wager/100).formatMoney(2,".",",")+'</span> Bits! <div class="info"><a href="https://www.moneypot.com/bets/'+e.id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#highRoller_logs").html()):$("#highRoller_logs").html('<div class="hr_log_item" style="border-left: 4px solid #8D4;"><b><a class="hr_log_item_username" href="https://www.moneypot.com/users/'+e.uname+'">'+e.uname+'</a></b>: <span style="color: #8D4">'+parseFloat(e.wager/100).formatMoney(2,".",",")+'</span> Bits! <div class="info"><a href="https://www.moneypot.com/bets/'+e.id+'" target="_blank"><i class="info circle icon"></i></a></div></div>'+$("#highRoller_logs").html()),$(".hr_log_item").each(function(e){e>10&&$(this).remove()})),$(".allbets_log_item").each(function(e){e>8&&$(this).remove()})}),socket.on("balance_change",function(e){$("#balance").text((e.balance/100).formatMoney(2,".",",")),user_balance=e.balance/100})}),Number.prototype.formatMoney=function(e,t,a){var o=this,e=isNaN(e=Math.abs(e))?2:e,t=void 0==t?".":t,a=void 0==a?",":a,s=0>o?"-":"",n=parseInt(o=Math.abs(+o||0).toFixed(e))+"",i=(i=n.length)>3?i%3:0;return s+(i?n.substr(0,i)+a:"")+n.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+a)+(e?t+Math.abs(o-n).toFixed(e).slice(2):"")},$("#depositButton").click(function(){$.get("https://api.moneypot.com/v1/deposit-address?access_token="+access_token,function(e){$("#depositForm").modal("setting","closable",!1).modal("show"),"undefined"!=typeof e.deposit_address?$("#depositBtcAddy").html('<i class="mail icon"></i>'+e.deposit_address):$("#depositBtcAddy").text("Couldn't request a deposit addy. Please, use moneypot.")})}),$("#tipButton").click(function(){$("#tippingForm").modal("setting","closable",!1).modal("show")}),$("#sendTipButton").click(function(){$("#sendTipButton").addClass("loading"),$("#sendTipButton").attr("disabled",!0);var e=$("#tipping_username_input").val(),t=$("#tipping_amount_input").val(),a=confirm("Are you sure to tip "+t+" Bits to "+e+" ?");1==a&&t==parseFloat(t)&&$.ajax({type:"POST",contentType:"application/json",url:"https://api.moneypot.com/v1/tip?access_token="+access_token,data:JSON.stringify({uname:e,amount:Math.floor(100*t)}),dataType:"json",error:function(t,a,o){console.error("[TIP ERROR]",t.responseText),addNewChatMessage({created_at:(new Date).getTime().toISOString(),text:"Error when sending tip to "+e+": "+t.responseText.error})}}).done(function(a){a.id?(addNewChatMessage({created_at:(new Date).toISOString(),text:"Sent "+t+" Bits to "+e}),user_balance-=t,$("#balance").text(user_balance.formatMoney(2,".",","))):addNewChatMessage({created_at:(new Date).getTime().toISOString(),text:"Error when sending tip to "+e+": "+a}),$("#tippingForm").modal("hide"),$("#sendTipButton").removeClass("loading"),$("#sendTipButton").attr("disabled",!1),$("#tipping_username_input").val(""),$("#tipping_amount_input").val("")})}),$("#moneypotDepositButton").click(function(){var e="https://www.moneypot.com/dialog/deposit?app_id=2286",t="manage-auth",a="width=420,height=350,left=100,top=100",o=window.open(e,t,a);o.focus()}),$("#withdrawButton").click(function(){var e="https://www.moneypot.com/dialog/withdraw?app_id=2286",t="manage-auth",a="width=420,height=350,left=100,top=100",o=window.open(e,t,a);o.focus()}),$("#faucetButton").click(function(){$(this).hasClass("claimed")||(0==showingrecaptcha?($("#faucetClaimCaptcha").slideDown("fast"),showingrecaptcha=!0,console.log("showing google recaptcha")):1==showingrecaptcha&&($("#faucetClaimCaptcha").slideUp("fast"),showingrecaptcha=!1,console.log("hiding google recaptcha")))}),$("#bombsButtons .button").each(function(e){$(this).click(function(){$("#bombsButtons .button").each(function(){$(this).removeClass("active")}),$(this).addClass("active"),0===e?game.bombs=1:1===e?game.bombs=3:2===e?game.bombs=5:3===e?game.bombs=24:4===e&&(game.bombs=parseInt($("#customBombs").val())),$(this).hasClass("customBombsButton")?$("#customBombsInputArea").css("display","inline-flex"):$("#customBombsInputArea").css("display","none")})});var houseEdge,odds,next;$("#startNewGameButton").click(function(){startNewGame()}),$("#cashoutButton").click(function(){var e=!1;if($(".tile").each(function(t){$(this).hasClass("tileLoading")&&(e=!0)}),!e){$(this).css("display","none"),$("#logs").html('<div class="log_item item"><img class="ui avatar image" src="lib/css/img/cashout-list.png"><div class="content"><a class="header">Back to quarters</a><div class="description"><p>Finished baking. Total earned: '+parseFloat(game.stake).formatMoney(2,".",",")+" bits</p></div></div></div>"+$("#logs").html()),$(".game_log_button").append('<button id="playAgainButton" class="ui green button">Bake Again</button>'),$("#playAgainButton").click(function(){$("#game_actions").css("display","none"),$("#playAgainButton").remove(),$("#board").html(boardHtml),$("#customBombs").val(game.bombs),$("#startNewGameButton").click(function(){startNewGame()}),$("#bombsButtons .button").each(function(e){$(this).click(function(){$("#bombsButtons .button").each(function(){$(this).removeClass("active")}),$(this).addClass("active"),0===e?game.bombs=1:1===e?game.bombs=3:2===e?game.bombs=5:3===e?game.bombs=24:4===e&&(game.bombs=parseInt($("#customBombs").val())),$(this).hasClass("customBombsButton")?$("#customBombsInputArea").css("display","inline-flex"):$("#customBombsInputArea").css("display","none")})}),game={status:"ENDED",profit:game.stake,bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#bet").val(game.bet)});for(var t=0;t<game.bombs;t++){var a=[];$(".tile").each(function(e){$(this).hasClass("pressed")||$(this).hasClass("reveal")||a.push(e)}),roll=Math.floor(Math.random()*a.length)+1,$(".tile:eq("+a[roll-1]+")").addClass("reveal").html('<img class="ui fluid image" src="lib/css/img/toasted.png" alt="toasted-donutbit.com" >')}$("#cashoutButton").css("display","none"),game={status:"ENDED",profit:0-parseFloat($("#bet").val()),bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#next_value").text(parseFloat(game.next).formatMoney(2,".",",")),$("#stake_value").text(parseFloat(game.stake).formatMoney(2,".",",")),$(".log_item").each(function(e){e>5&&$(this).remove()}),console.log(game),$(".settingsButon").css("display","inline-block")}}),$(document).keypress(function(e){if(68==e.which&&$("input:focus").length<=0)if("IN_PROGRESS"==game.status)$("#cashoutButton").css("display","none"),$("#logs").html('<div class="log_item item"><img class="ui avatar image" src="lib/css/img/cashout-list.png"><div class="content"><a class="header">Back to quarters</a><div class="description"><p>Finished baking. Total earned: '+parseFloat(game.stake).formatMoney(2,".",",")+" bits</p></div></div></div>"+$("#logs").html()),
$("#board").html(boardHtml),$("#customBombs").val(game.bombs),$(".game_log_button").append('<button id="playAgainButton" class="ui green button">Bake Again</button>'),$("#startNewGameButton").click(function(){startNewGame()}),$("#bombsButtons .button").each(function(e){$(this).click(function(){$("#bombsButtons .button").each(function(){$(this).removeClass("active")}),$(this).addClass("active"),0===e?game.bombs=1:1===e?game.bombs=3:2===e?game.bombs=5:3===e?game.bombs=24:4===e&&(game.bombs=parseInt($("#customBombs").val())),$(this).hasClass("customBombsButton")?$("#customBombsInputArea").css("display","inline-flex"):$("#customBombsInputArea").css("display","none")})}),game={status:"ENDED_AWAITING",profit:game.stake,bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#bet").val(game.bet),$("#next_value").text(parseFloat(game.next).formatMoney(2,".",",")),$("#stake_value").text(parseFloat(game.stake).formatMoney(2,".",",")),$(".log_item").each(function(e){e>5&&$(this).remove()}),console.log(game),$(".settingsButon").css("display","inline-block");else{if("?"==game.status||"ENDED_AWAITING"==game.status)return void startNewGame();$("#playAgainButton").remove(),$("#board").html(boardHtml),$("#customBombs").val(game.bombs),$("#startNewGameButton").click(function(){startNewGame()}),$("#bombsButtons .button").each(function(e){$(this).click(function(){$("#bombsButtons .button").each(function(){$(this).removeClass("active")}),$(this).addClass("active"),0===e?game.bombs=1:1===e?game.bombs=3:2===e?game.bombs=5:3===e?game.bombs=24:4===e&&(game.bombs=parseInt($("#customBombs").val())),$(this).hasClass("customBombsButton")?$("#customBombsInputArea").css("display","inline-flex"):$("#customBombsInputArea").css("display","none")})}),game={status:"ENDED_AWAITING",profit:game.stake,bet:parseFloat(betSave),bombs:game.bombs,clientSeed:game.clientSeed,tilesClicked:0,odds:0,next:0,stake:0},$("#bet").val(game.bet)}}),$("#balanceRefreshButton").click(function(){$("#balanceRefreshIcon").addClass("loading"),$.getJSON("https://api.moneypot.com/v1/auth?access_token="+access_token,function(e){$("#balanceRefreshIcon").removeClass("loading"),$("#balance").text((e.user.balance/100).formatMoney(2,".",",")),user_balance=e.user.balance/100,addNewChatMessage({created_at:(new Date).toISOString(),text:"Balance refreshed! Amount: "+(e.user.balance/100).formatMoney(2,".",",")+" Bits"})})}),$(".viewMyBetsButton").click(function(){console.log("Loading My bets history..."),$("#game_jackpotwinners_log").css("display","none"),$("#game_mybets_log").css("display","block"),$("#game_allbets_log").css("display","none")}),$(".viewAllBetsButton").click(function(){console.log("Loading All bets history..."),$("#game_jackpotwinners_log").css("display","none"),$("#game_mybets_log").css("display","none"),$("#game_allbets_log").css("display","block")}),$(".viewJackpotWinnersButton").click(function(){console.log("Loading Jackpot winners history..."),$("#game_jackpotwinners_log").css("display","block"),$("#game_mybets_log").css("display","none"),$("#game_allbets_log").css("display","none")}),$("#logoutButton").click(function(){"undefined"!=typeof $.session.get("session_access_token")&&$.session.remove("session_access_token"),window.location.href="/"}),$("#jackpot_help_button").click(function(){$("#jackpotHelpModal").modal("show")}),$(document).ready(function(){$(".noSpacesboxes").on({keydown:function(e){return 32===e.which?!1:void 0},change:function(){this.value=this.value.replace(/\s/g,"")}})});var custom={saveBet:function(e,t){var a={url:"save.php",type:"post",dataType:"json",data:{donut_name:e,bet:t},success:function(e){"success"==e.status?console.log(e.message):(console.log("Error!"),console.log(e.message))},error:function(e){console.log("Error!"),console.log(e)}};$.ajax(a)},username:""};
